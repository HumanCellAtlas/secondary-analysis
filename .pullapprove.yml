version: 3

extends: https://api.github.com/repos/example/pullapprove-config/contents/.pullapprove.yml

pullapprove_conditions:
- "'WIP' not in title"
- "base.ref == 'master'"
- "'hotfix' not in labels"
- "'*travis*' in statuses.succeeded"

notifications:
- when: pull_request.opened
  # only need to send this to external-contributors
  if: "author_association in ['FIRST_TIMER', 'FIRST_TIME_CONTRIBUTOR', 'CONTRIBUTOR']"
  comment: >
    Hey @{{ author }}, please make sure your tests pass and you have looked everything over. Then we will review.

    Thanks for the PR!
- when: pullapprove.approved
  comment: "The review is completed. @exampleuser, please merge this in when ready."

groups:
  pullapprove-admins:
    required: 1
    conditions:
      files:
        - ".pullapprove.yml"
    users:
      - rhiananthony
    teams:
      - dsp-devops
    author_approval:
      ignored: true

  master-reviewers:
    required: 1
    teams:
      - dsde-pipelines-developers
      - dsp-devops
    author_approval:
      ignored: true
    conditions:
      branches:
        - master # only need to approve if merging to master
